<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="{% static 'css/project_view.css' %}">
    <link rel="stylesheet" href="{% static 'css/clinic_card.css' %}">
</head>

<style>
</style>

<body class="body">


<div class="header">
<p>Clinic Selection Form</p> 

<div class="userInfo" data-user-email="{{student.email}}" data-user-major="{{student.major}}">
  <p>{{user.email}} 
  <button id="infoButton" class="infoButton"> I </button></p>
    <div class="popup" id="legendPopup">
                    <div class="itemContents">
                    <p class="clinic-title">Clinic Title</p>

                    <img src="" class="imageSlot" alt="Clinic image">

                    <div class="managers">
                      <a href="mailto:manager1@example.com">Manager 1</a> |
                      <a href="mailto:manager2@example.com">Manager 2</a>
                      <br>
                    </div>

                    <br>
                    <br>
                    (Click Card for more info...)

                    <div class="specificRequestHolder">
                      {% for major in majors %}
                      <div class="specificRequest" style="--color: {{major.color}};"> {{major}} </div>
                      {%endfor%}
                    </div>
                  </div>
    </div>
  </p>
  <label for="clinic-department-filter">Filter by department:</label>
    <select id="clinic-department-filter">
      <option value="all">All</option>
      {% for major in majors %}
      <option value="{{ major.major }}">{{ major.major }}</option>
      {% endfor %}
    </select>
  <label for="show-accepting">Filter by clinics accepting major</label>
    <input type="checkbox" id="show-accepting" />
</div>




</div>

  

<!-- This is the Grid, it contains all the clinics, which will be procedurally loaded via Djangos automation -->
 <div class="main">

<div class="gridWrapper"> 
<div class="grid">

  
    
    <!-- Each item must be of class item -->
    {% for clinic in clinics %}
    <div class="item" 
      style="--clinic-color: {{clinic.department.color}}" 
      data-department="{{ clinic.department }}" 
      data-is-general="{{ clinic.numberHandler.first.general }}" 
      {% if clinic.numberHandler.first.general %} 
        data-max="{{ clinic.numberHandler.first.max }}"
      {% else %}
        {% for handler in clinic.numberHandler.all %}
          {% if handler.major == student.major %}
            data-max="{{ handler.max }}"
          {% endif %}
        {% endfor %}
      {% endif %}
    >
      <input type="hidden" name="clinic_name" value="{{clinic.title}}"> <!-- Used to identify which clinics are selected-->
            <div class="itemContents" >
                <p class="clinic-title">{{clinic.title}}</p>
                {%if clinic.image%}
                <img src="{{clinic.image.url}}" class="imageSlot">
                {%else%}
                <p class="imageSlot" >No image provided</p>
                {%endif%}
                <div class="managers">           
                  {%for manager in clinic.clinic_mgmt.all%}
                  <a href = "mailto:{{manager.email}}">{{manager.last_name}}</a> {%if not forloop.last%} | {%endif%}
                  {%endfor%}
                  <br>
                </div>
                {%if clinic.numberHandler.first.general == True %}
                <div class="generalRequest">  General: {{clinic.numberHandler.first.max}} </div>
                {%else%}
                <div class="specificRequestHolder">
                {%for major in majors%}
                
                {%for handler in clinic.numberHandler.all %}
                {% if major.major == handler.major.major %}
                <div class="specificRequest" style="--color: {{major.color}};"> {{handler.max}} </div>
                {%else%}
                {%endif%}
                {%endfor%}
                
                {%endfor%}
                
                  
                  
                </div>
                
                {%endif%}

            </div>
            <div class="clinicDetails hidden itemContents">
                <p class="clinic-title">{{clinic.title}}</p>
                <div class="linkList">
                {%for link in clinic.links_list%}
                    <a href="{{link}}"> [{{forloop.counter}}] </a>
                {%endfor%}
                </div>

                
                
                <div class="description">
                  {{clinic.description}}
                </div>
                
            </div>
    </div>
    {% endfor %}

</div>

</div>

<!-- End Grid -->

<!-- Starting Selection Grid-->



<form method="POST" id="submission-form" class="clinicSelection">
    {% csrf_token %}
    <div>
      <p>Top  8 Clinic Choices</p>
    </div>
    <button id="submit-button" type="submit" class="pushable">
        <span class="shadow"></span>
        <span class="edge"></span>
        <span class="front"> Submit</span>
    </button>
<div class="select-gridWrapper">
  <div class="select-grid" > <!-- Selection grid for chosen clinics   -->
    {%for clinic in selected_clinics %}
    <div class="item" style="--clinic-color: {{clinic.department.color}}">
      <input type="hidden" name="clinic_name" value="{{clinic.title}}"> <!-- Used to identify which clinics are selected-->
            <div class="itemContents" >
                <p class="clinic-title">{{clinic.title}}</p>
                {%if clinic.image%}
                <img src="{{clinic.image.url}}" class="imageSlot">

                {%else%}
                <p class="imageSlot" >No image provided</p>
                {%endif%}
                <div class="managers">           
                  {%for manager in clinic.clinic_mgmt.all%}
                  <a href = "mailto:{{manager.email}}">{{manager.last_name}}</a> {%if not forloop.last%} | {%endif%}
                  {%endfor%}
                  <br>
                </div>
                {%if clinic.numberHandler.first.general == True %}
                <div class="generalRequest">  General: {{clinic.numberHandler.first.max}} </div>
                {%else%}
                <div class="specificRequestHolder">
                {%for major in majors%}
                
                {%for handler in clinic.numberHandler.all %}
                {% if major.major == handler.major.major %}
                <div class="specificRequest" style="--color: {{major.color}};"> {{handler.max}} </div>
                {%else%}
                {%endif%}
                {%endfor%}
                
                {%endfor%}
                
                  
                  
                </div>
                
                {%endif%}

            </div>
            
    </div>
    {%endfor%}
  </div>
</form>

</div>




 </div>
</body>






<script src="https://cdn.jsdelivr.net/npm/muuri@0.9.5/dist/muuri.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/web-animations-js@2.3.2/web-animations.min.js"></script>
<script>

    // Remove button functionality, triggering grid remove
    
    
</script>
<script src="{% static 'js/projectView.js' %}"></script>

</html>